@{
    ViewData["Title"] = @Localizer["Interval Exam"];
}

<div id="localization-data" data-perfect-unison="@Localizer["Perfect Unison"]"
    data-minor-second="@Localizer["Minor Second"]" data-major-second="@Localizer["Major Second"]"
    style="display: none;">
</div>

<div class="container-fluid py-4">
    <div class="row g-4 justify-content-center">
        <div class="col-lg-4">
            <h1 id="questionLabel"></h1>
        </div>
        <div class="col-lg-7">

            <div id="question-staff-container"
                class="d-flex flex-column flex-md-row align-items-center gap-3 flex-wrap">

            </div>
        </div>
    </div>

    <div class="row g-4 justify-content-center mb-4">
        <h1>Select Answer</h1>
    </div>

    <div class="row g-4 justify-content-center">
        <div class="col-lg-4">

            <div id="staff-answer1-container"
                class="d-flex flex-column flex-md-row justify-content-center align-items-center gap-3 flex-wrap exam-answer">

            </div>
        </div>
        <div class="col-lg-4">

            <div id="staff-answer2-container"
                class="d-flex flex-column flex-md-row justify-content-center align-items-center gap-3 flex-wrap exam-answer">

            </div>
        </div>
        <div class="col-lg-4">

            <div id="staff-answer3-container"
                class="d-flex flex-column flex-md-row justify-content-center align-items-center gap-3 flex-wrap exam-answer">

            </div>
        </div>
    </div>
</div>


@* ReSharper disable once Razor.SectionNotResolved *@
@section scripts {
    @* 1. 引用我们新的、解耦的控件 *@
    <script src="~/scripts/MusicStaff.js"></script>
    <script src="~/scripts/interval-exam.js"></script>
    <script>
        // --- 2. 启动逻辑 ---
        window.addEventListener('load', () => {

            // --- A. 获取所有 DOM 元素 ---
            const questionStaffEl = document.getElementById('question-staff-container');
            const answer1El = document.getElementById('staff-answer1-container');
            const answer2El = document.getElementById('staff-answer2-container');
            const answer3El = document.getElementById('staff-answer3-container');
            const questionLabel = document.getElementById('questionLabel');

            // 将可点击的容器放入数组
            const answerElements = [answer1El, answer2El, answer3El];

            // --- B. 创建 MusicStaff 实例 ---
            // [注意] 确保你引用的是 'MusicStaff.js' (而不是 staff.js)
            const questionStaff = new MusicStaff(questionStaffEl.id, { clef: 'treble' });

            const answerStaffs = [
                new MusicStaff(answer1El.id, { clef: 'treble' }),
                new MusicStaff(answer2El.id, { clef: 'treble' }),
                new MusicStaff(answer3El.id, { clef: 'treble' })
            ];

            // --- C. 创建 ExamQuestion 实例 ---
            // [修改] 传入 staff 实例 *和* 可点击的 HTML 元素
            const examQuestion = new ExamQuestion(
                questionStaff,
                answerStaffs,
                answerElements,
                questionLabel
            );

            // --- D. 开始考试! ---
            examQuestion.nextQuestion();
        });
    </script>
}

@* ReSharper disable once Razor.SectionNotResolved *@
@section styles {
    <link rel="stylesheet" href="~/styles/site.css" />
}
